<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2018 IT-SHOW</title>
  <!-- materialize의 각종 아이콘 집합 css -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- materialize css -->
  <link rel="stylesheet" type="text/css" href="css/materialize.css">
  <!-- 나눔고딕 폰트 -->
  <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
  <div class="apply">
    <div class="container">
      <div class="icon">
        <center>
          <br>
          <img src="img/mirim_icon.png" class="applyIcon">
        </center>
      </div>
      <br>

      <div class="card" id="CARD">
        <form id="FORM">
          <br>
          <br>
          <br>
          <br>
          <form class="col s12">
            <!-- 학과 selectBox 선택 -->

            <div class="row">
                <!-- 학과 선택 -->
                <div class="input-field col s4">
                    <select id="MAJOR_SELECT">
                        <option value="" disabled selected>학과 선택</option>
                        <option value="softwareMajor">소프트웨어과(솔루과/인미과)</option>
                        <option value="designMajor">디자인과</option>
                    </select>
                </div>
            
                <!-- 작품 카테고리 입력 -->
                <div class="input-field col s8">
                    <select id="CATEGORY_SELECT">
                        <option value="" disabled selected>분류 선택</option>
                        <option value="1">콩닥콩닥 입학준비</option>
                        <option value="2">두근두근 등교준비</option>
                        <option value="3">으싸으쌰 학교생활 (팔짝팔짝 국어/체육)</option>
                        <option value="4">으싸으쌰 학교생활 (왁자지껄 쉬는시간)</option>
                        <option value="5">으싸으쌰 학교생활 (깡충깡충 전공교과)</option>
                        <option value="6">으싸으쌰 학교생활 (와글와글쉬는시간)</option>
                        <option value="7">성큼성큼 영마이스터</option>
                        <option value="8">생글생글 귀가하기</option>            
                    </select>
                </div>
            </div>


            <div class="row">
              <!-- 작품명 입력 -->
              <div class="input-field col s12">
                <input id="NAME_INPUT" type="text">
                <label for="NAME_INPUT">작품명을 입력해주세요.</label>
              </div>
             
            </div>


            <div class="row">
                <!--태그 입력 -->
                <div class="input-field col s12">
                    <input id="TAG_INPUT" type="text" >
                    <label for="TAG_INPUT">작품과 관련된 해시태그를 2개 적어주세요. ex)#구지뽕,#김소뽕</label>
                  </div>
              </div>
  

            <!-- 지원 동기 입력  -->
            <div class="row">
              <div class="input-field col s12">
                <textarea id="DES_INPUT" class="materialize-textarea" data-length="50"></textarea>
                <label for="DES_INPUT">작품설명을 간략히 작성해주세요.(50자 내외)</label>
              </div>
            </div>


            <br><br>
            <!--  폼 전송 버튼 -->
            <div class="row">
              <div class = "col right">
                  <a id="SUBMIT_BTN" class="waves-effect green darken-2 btn right">
                      <i class="material-icons left">send</i>제 출 하 기</a>
              </div>

              <div class = "col right">
                  <a id="CANCEL_BTN" class="waves-effect green darken-2 btn right">
                  <i class="material-icons left">close</i>취 소 하 기</a> &nbsp;
              </div>
            </div>

            <br><br>
          </form>
          <!-- size 지정 form -->
      </div>
      <!-- card div -->
      </form>

     
    </div>

    <span class = "madeBy">
        @ITKOO
        <br>
      </span>
  </div>

  <!-- 컨테이너 div -->


  <!-- !!!!!!!!!!!!!!!!! script영역 !!!!!!!!!!!!!!!!!!!!!  -->

  <!-- firebase 관련 js -->
  <script src="https://www.gstatic.com/firebasejs/4.6.1/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase-storage.js"></script>


  <!-- firebase config 관련 js -->
  <script src="js/fireinit.js"></script>

  <!-- jquery cdn -->
  <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>

  <!-- materialize.js -->
  <script type="text/javascript" src="js/materialize.js"></script>

  <script>
    $(document).ready(function () {
      console.log("%c 2018년 ITSHOW 대박기원.", "color: #FFBB00; font-style: bold; font-size: 35px");
      // materialize 에서 selectbox가 보이게 할려면 이 코드를 반드시 작성
      $('select').material_select();

      // 입력 창 밑에 몇 글자 작성했는지 체크
      $('input#EXPRESS_INPUT, textarea#DES_INPUT, textarea#WANT_TO_DO_INPUT').characterCounter();
    });

   $("#CANCEL_BTN").click(function() {
        var txt;
        var cancle = confirm("정말로 IT-Show 폼작성을 취소하시겠습니까?");
        if (cancle == true) {
           location.href = 'index.html';
        } else {
            return false;
        }  
   });

   $("#SUBMIT_BTN").click(function () {
     
      var isGood; // 제대로 입력했는지 체크
      // select box에서 선택한 value 값 변수에 저장
      var major_select = $("#MAJOR_SELECT").val(); // 학과 선택
      var category_select = $("#CATEGORY_SELECT").val(); // 작품 카테고리 선택
    

      var workName = $("#NAME_INPUT").val(); // 작품이름
      var tag = $("#TAG_INPUT").val(); // 해시태그
      var des = $("#DES_INPUT").val(); // 작품설명
    

      // 유효성 체크(값이 없으면 쓰라고 alert창!)
      if (major_select == null || category_select == null) {
        alert("학과 및 카테고리를 선택해주세요.");
        isGood = false;
      } 

      else if (workName == "") {
        alert("작품명을 입력해주세요.");
        isGood = false;
      } else if (tag == "") {
        alert("해시태그를 입력해주세요.");
      } else if (des == "") {
        alert("작품설명을 입력해주세요.");
        isGood = false;
      } else {
        isGood = true;
      }

    
    // form 내용이 저장될 주소
      var formRef = firebase.database().ref("IT-Show/Form/" +major_select + "/" +  workName + "/Content");

      if (isGood == true) {
       
        formRef.set({
          workName: workName,
          major_select: major_select,
          category_select: category_select,
          tag: tag,
          des: des
        }).then(function () {
          console.log("workName : " + workName);
          console.log("major_select : " + major_select);
          console.log("category_select : " + category_select);
          console.log("tag : " + tag);
          console.log("des : " + des);
         
          alert(workName + "팀님 ITSHOW 폼 입력이 완료되셨습니다! 감사드려요:)");
          window.location.href = "index.html";
        });

      } // end of if

    }); // end of SUBMIT_BTN

  </script>
</body>

</html>